// This file would normally be generated by Flex

#include <stdio.h>
#include <stdlib.h>
#include <ctype.h> 
#include "types.h"
#include "calc.tab.h"

FlowNode* functionWants( char nextChar, FlowNode* current ){
    // TODO
    return NULL;
}

int yylex( FlowNode* root, char** start)
{
    //left over from last iteration
    static int tokens = 0;
    // TODO, remove later, just so that it compiles and runs.
    int token = 267;
    int yychar;
    FlowNode* current = root;
    FlowNode* next;

    // get only if tokens empty.
    if ( tokens == 0 ) {
        yychar = fgetc( yyin );
    } else {
        yychar = tokens;
        tokens = 0;
    }

    while( (next = functionWants( yychar, current )) != NULL ) {
        current = next;
        //TODO: append character to string
        //get new character
        yychar = fgetc( yyin );
        // TODO check all input for error.  
    }

    // save left over character
    tokens = yychar;
    // populate yytext based on data collected
    //TODO: populate( yytext, &start );
    // TODO: get the token from the current
    return token;
}

int main(int argc, char *argv[])
{

   if (argc <= 1)
   {
      printf("USAGE: calc inputfilename\n");
      exit(EXIT_FAILURE);
   }
   
   yyparse(argv[1]);
   
   return 0;
}
